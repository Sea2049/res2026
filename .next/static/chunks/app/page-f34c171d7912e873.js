(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2155:function(e,t,r){Promise.resolve().then(r.bind(r,8208))},8208:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var s=r(7437),a=r(2265),l=r(1994),n=r(3335);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,l.W)(t))}function o(e,t){return e.length<=t?e:e.slice(0,t)+"..."}function c(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function d(e){let{value:t,onChange:r,onSearch:l,isLoading:n=!1,placeholder:o="输入关键词搜索 Subreddit 或 Post...",className:c,searchHistory:d=[],onHistoryClick:u,onClearHistory:h,onRemoveHistory:m}=e,[x,b]=(0,a.useState)(""),[g,p]=(0,a.useState)(!1),y=(0,a.useRef)(null),f=(0,a.useRef)(null);(0,a.useEffect)(()=>{t.trim()&&b("")},[t]),(0,a.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&y.current&&!y.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let v=()=>{if(!t.trim()){b("请输入搜索关键词");return}p(!1),l()},j=e=>{r(e),p(!1),null==u||u(e)},w=(e,t)=>{e.stopPropagation(),null==m||m(t)};return(0,s.jsxs)("div",{className:i("relative",c),children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{ref:y,type:"text",value:t,onChange:e=>{let t=e.target.value;if(t.length>100){b("关键词长度不能超过 100 个字符");return}b(""),r(t)},onKeyDown:e=>{"Enter"===e.key&&v()},onFocus:()=>{d.length>0&&p(!0)},placeholder:o,className:i("flex-1 px-4 py-2 border rounded-lg","focus:outline-none focus:ring-2 focus:ring-blue-500","disabled:opacity-50 disabled:cursor-not-allowed",x&&"border-red-500"),disabled:n,"aria-label":"搜索输入框","aria-invalid":!!x,"aria-describedby":x?"search-error":void 0,"aria-expanded":g,"aria-controls":"search-history-dropdown"}),(0,s.jsx)("button",{onClick:v,disabled:n||!t.trim(),className:i("px-6 py-2 bg-blue-600 text-white rounded-lg","hover:bg-blue-700 active:bg-blue-800","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200"),"aria-label":"搜索按钮",children:n?"搜索中...":"搜索"})]}),x&&(0,s.jsx)("p",{id:"search-error",className:"text-red-500 text-sm",role:"alert",children:x})]}),g&&d.length>0&&(0,s.jsxs)("div",{ref:f,id:"search-history-dropdown",className:"absolute top-full left-0 right-0 mt-2 bg-white border rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",role:"listbox","aria-label":"搜索历史",children:[(0,s.jsxs)("div",{className:"p-2 border-b flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"搜索历史"}),(0,s.jsx)("button",{onClick:()=>{p(!1),null==h||h()},className:"text-xs text-blue-600 hover:text-blue-800 underline","aria-label":"清空历史记录",children:"清空"})]}),(0,s.jsx)("ul",{role:"list",children:d.map((e,t)=>(0,s.jsxs)("li",{role:"option",className:"px-3 py-2 hover:bg-gray-100 cursor-pointer flex items-center justify-between group",onClick:()=>j(e),children:[(0,s.jsx)("span",{className:"flex-1 text-sm text-gray-700 truncate",children:e}),(0,s.jsx)("button",{onClick:t=>w(t,e),className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-600 transition-opacity","aria-label":"删除 ".concat(e),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e))})]})]})}function u(e){let{topic:t,isSelected:r=!1,onToggleSelect:a,className:l}=e,n="subscriber_count"in t,d=()=>n?"社区":"帖子";return(0,s.jsx)("div",{onClick:e=>{e.target instanceof HTMLAnchorElement||null==a||a()},className:i("p-4 border rounded-lg cursor-pointer","hover:shadow-md transition-shadow duration-200","bg-white",r&&"ring-2 ring-blue-500 bg-blue-50",l),role:"button",tabIndex:0,"aria-pressed":r,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),null==a||a())},children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("span",{className:i("px-2 py-0.5 text-xs font-medium rounded",n?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:d()}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:n?c(t.title||t.display_name):c(t.title)})]}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:n?c(o(t.description||"暂无描述",150)):c(o(t.selftext||t.title,150))}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,s.jsx)("span",{children:n?"".concat(function(e){let t;if(0===e)return"0";if(e<1e3)return e.toString();let r=["","K","M","B"],s=Math.floor((""+Math.floor(e)).length/3);for(let a=s?2:1;a<(s?3:2);a++)if((t=parseFloat((e/Math.pow(1e3,a)).toPrecision(3)))%1!=0&&(t=Math.floor(10*t)/10),t<1e3)return t+r[a];return e.toString()}(t.subscriber_count)," 订阅者"):"".concat(t.score," 点赞 \xb7 ").concat(t.num_comments," 评论 \xb7 ").concat(function(e){let t=Math.floor(Date.now()/1e3-e);for(let[e,r]of Object.entries({年:31536e3,月:2592e3,周:604800,天:86400,小时:3600,分钟:60})){let s=Math.floor(t/r);if(s>=1)return"".concat(s).concat(e,"前")}return"刚刚"}(t.created_utc))}),n&&(0,s.jsxs)("span",{className:"text-gray-400",children:["r/",c(t.name)]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:r,onChange:e=>{e.stopPropagation(),null==a||a()},className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer","aria-label":"选择".concat(d())}),(0,s.jsx)("a",{href:n?"https://www.reddit.com".concat(t.url):t.url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-xs text-blue-600 hover:text-blue-800","aria-label":"打开".concat(d(),"链接"),children:"查看详情"})]})]})})}function h(e){let{topics:t,selectedTopicIds:r,onToggleSelect:a,isLoading:l=!1,error:n=null,searchKeyword:o="",className:c}=e;return(0,s.jsx)("div",{className:i("space-y-4",c),children:l?(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"p-4 border rounded-lg bg-gray-50 animate-pulse","aria-hidden":"true",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-full"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]}),(0,s.jsx)("div",{className:"w-5 h-5 bg-gray-200 rounded"})]})},t))}):n?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"⚠️"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"搜索失败"}),(0,s.jsx)("p",{className:"text-gray-300 mb-4",children:n||"网络请求失败，请稍后重试"})]}):0===t.length?o?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD0D"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"未找到相关结果"}),(0,s.jsx)("p",{className:"text-gray-300",children:"尝试使用其他关键词搜索"})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCB"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"开始搜索主题"}),(0,s.jsx)("p",{className:"text-gray-300",children:"输入关键词搜索感兴趣的 Subreddit 或 Post"})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-300",children:[(0,s.jsxs)("span",{children:["搜索结果：",(()=>{let e=t.filter(e=>"subscriber_count"in e).length,r=t.filter(e=>!("subscriber_count"in e)).length;return e>0&&r>0?"".concat(e," 个社区 \xb7 ").concat(r," 个帖子"):e>0?"".concat(e," 个社区"):r>0?"".concat(r," 个帖子"):"0 个结果"})()]}),(0,s.jsxs)("span",{children:["已选 ",r.size," 个"]})]}),t.map(e=>(0,s.jsx)(u,{topic:e,isSelected:r.has(e.id),onToggleSelect:()=>a(e)},e.id))]})})}function m(e){let{options:t,onOptionsChange:r,className:l}=e,[n,o]=(0,a.useState)(!1),c=e=>{r({...t,sortBy:e})},d=e=>{r({...t,timeRange:e})},u=e=>{r({...t,limit:e})},h=e=>{r({...t,subredditOnly:"subreddit"===e,postOnly:"post"===e})};return(0,s.jsxs)("div",{className:i("space-y-4",l),children:[(0,s.jsxs)("button",{onClick:()=>{o(!n)},className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 transition-colors","aria-expanded":n,"aria-controls":"advanced-options-panel",children:[(0,s.jsx)("span",{children:"高级搜索选项"}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:i("h-4 w-4 transition-transform duration-200",n?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&(0,s.jsxs)("div",{id:"advanced-options-panel",className:"p-4 bg-gray-800 border border-gray-700 rounded-lg space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"搜索类型"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>h("all"),className:i("px-4 py-2 rounded-lg text-sm transition-colors",t.subredditOnly||t.postOnly?"bg-white text-gray-700 hover:bg-gray-100":"bg-blue-600 text-white"),"aria-pressed":!t.subredditOnly&&!t.postOnly,children:"全部"}),(0,s.jsx)("button",{onClick:()=>h("subreddit"),className:i("px-4 py-2 rounded-lg text-sm transition-colors",t.subredditOnly?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),"aria-pressed":t.subredditOnly,children:"仅社区"}),(0,s.jsx)("button",{onClick:()=>h("post"),className:i("px-4 py-2 rounded-lg text-sm transition-colors",t.postOnly?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),"aria-pressed":t.postOnly,children:"仅帖子"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"排序方式"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:[{value:"relevance",label:"相关性"},{value:"hot",label:"热度"},{value:"new",label:"最新"},{value:"top",label:"最佳"}].map(e=>(0,s.jsx)("button",{onClick:()=>c(e.value),className:i("px-4 py-2 rounded-lg text-sm transition-colors",t.sortBy===e.value?"bg-blue-600 text-white":"bg-gray-700 text-gray-200 hover:bg-gray-600"),"aria-pressed":t.sortBy===e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"时间范围"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:"全部时间"},{value:"hour",label:"过去一小时"},{value:"day",label:"过去一天"},{value:"week",label:"过去一周"},{value:"month",label:"过去一月"},{value:"year",label:"过去一年"}].map(e=>(0,s.jsx)("button",{onClick:()=>d(e.value),className:i("px-4 py-2 rounded-lg text-sm transition-colors",t.timeRange===e.value?"bg-blue-600 text-white":"bg-gray-700 text-gray-200 hover:bg-gray-600"),"aria-pressed":t.timeRange===e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-200 mb-2",children:"结果数量"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:[10,20,50,100].map(e=>(0,s.jsx)("button",{onClick:()=>u(e),className:i("px-4 py-2 rounded-lg text-sm transition-colors",t.limit===e?"bg-blue-600 text-white":"bg-gray-700 text-gray-200 hover:bg-gray-600"),"aria-pressed":t.limit===e,children:e},e))})]})]})]})}function x(e){let{keyword:t,onSuggestionSelect:r,isLoading:l=!1,className:n}=e,[o,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(-1),h=(0,a.useRef)(null),m=(0,a.useMemo)(()=>{if(!t||t.length<2)return[];let e=t.toLowerCase(),r=[];return["how to","best","top","guide","tutorial","tips","tricks","help","what is","why"].forEach(e=>{r.push("".concat(e," ").concat(t))}),["for beginners","tutorial","guide","tips","best practices","examples","vs","vs"].forEach(e=>{r.push("".concat(t," ").concat(e))}),["javascript","python","gaming","cooking","fitness","travel","photography","music","movies","books","technology","science"].forEach(t=>{t.includes(e)&&r.push(t)}),Array.from(new Set(r)).slice(0,8)},[t]),x=(0,a.useMemo)(()=>{var e;let t;return e=e=>{c(e)},t=null,function(){for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];t&&clearTimeout(t),t=setTimeout(()=>{t=null,e(...s)},300)}},[]);(0,a.useEffect)(()=>{x(m)},[m,x]),(0,a.useEffect)(()=>{u(-1)},[o]);let b=e=>{r(e),c([]),u(-1)};return 0!==o.length||l?(0,s.jsx)("div",{ref:h,className:i("absolute top-full left-0 right-0 mt-2 bg-white border rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",n),role:"listbox","aria-label":"搜索建议",children:l?(0,s.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,s.jsx)("p",{className:"mt-2 text-sm",children:"加载建议中..."})]}):(0,s.jsx)("ul",{role:"list",children:o.map((e,t)=>(0,s.jsx)("li",{role:"option",className:i("px-4 py-2 cursor-pointer transition-colors","hover:bg-blue-50",d===t&&"bg-blue-100"),onClick:()=>b(e),onMouseEnter:()=>u(t),"aria-selected":d===t,children:(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})},e))})}):null}class b{async searchSubreddits(e){try{let t=await fetch("".concat(this.baseUrl,"/api/subreddit_autocomplete_v2.json?query=").concat(encodeURIComponent(e),"&include_over_18=false"));if(!t.ok)throw Error("API 请求失败: ".concat(t.status));return(await t.json()).children.map(e=>({id:e.data.id,name:e.data.name,display_name:e.data.display_name,title:e.data.title,description:e.data.public_description,subscriber_count:e.data.subscribers,url:e.data.url}))}catch(e){return console.error("搜索 Subreddits 失败:",e),[]}}async searchPosts(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"relevance",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;try{let l="".concat(this.baseUrl,"/search.json?q=").concat(encodeURIComponent(e),"&sort=").concat(r,"&limit=").concat(a);"all"!==s&&(l+="&t=".concat(s)),t&&(l+="&restrict_sr=true&sr=".concat(encodeURIComponent(t)));let n=await fetch(l);if(!n.ok)throw Error("API 请求失败: ".concat(n.status));return(await n.json()).data.children.map(e=>({id:e.data.id,title:e.data.title,selftext:e.data.selftext,author:e.data.author,subreddit:e.data.subreddit,score:e.data.score,num_comments:e.data.num_comments,created_utc:e.data.created_utc,url:e.data.url}))}catch(e){return console.error("搜索 Posts 失败:",e),[]}}async getComments(e,t){try{let r=await fetch("".concat(this.baseUrl,"/r/").concat(t,"/comments/").concat(e,".json?limit=100&sort=confidence"));if(!r.ok)throw Error("API 请求失败: ".concat(r.status));let s=await r.json(),a=[],l=e=>{for(let t of e)if("t1"===t.kind&&t.data){let e=t.data;e.body&&e.author&&a.push({id:e.id,author:e.author,body:e.body,score:e.score,created_utc:e.created_utc,parent_id:e.parent_id}),e.replies&&e.replies.data&&l(e.replies.data.children)}};return Array.isArray(s)&&s[1]&&l(s[1].data.children),a}catch(e){return console.error("获取评论失败:",e),[]}}async getSubredditPosts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=await fetch("".concat(this.baseUrl,"/r/").concat(e,"/hot.json?limit=").concat(t,"&sort=hot"));if(!r.ok)throw Error("API 请求失败: ".concat(r.status));return(await r.json()).data.children.map(e=>({id:e.data.id,title:e.data.title,selftext:e.data.selftext,author:e.data.author,subreddit:e.data.subreddit,score:e.data.score,num_comments:e.data.num_comments,created_utc:e.data.created_utc,url:e.data.url}))}catch(e){return console.error("获取 Subreddit 帖子失败:",e),[]}}async getMultiplePostComments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(!Array.isArray(e)||0===e.length)return[];let r=[],s=e.slice(0,10).map(async e=>(await this.getComments(e.id,e.subreddit)).slice(0,t));try{for(let e of(await Promise.all(s)))r.push(...e)}catch(e){console.error("批量获取评论失败:",e)}return r}async getSubredditComments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;try{let s=await this.getSubredditPosts(e,t);if(0===s.length)return[];return await this.getMultiplePostComments(s,r)}catch(e){return console.error("获取 Subreddit 评论失败:",e),[]}}constructor(){this.baseUrl="https://www.reddit.com"}}let g=new b,p={sortBy:"relevance",timeRange:"all",limit:20,subredditOnly:!1,postOnly:!1};function y(e){let{onSelectedTopicsChange:t,className:r}=e,{keyword:l,results:n,selectedTopicIds:i,selectedTopics:o,isLoading:c,error:u,searchOptions:b,setKeyword:y,setSearchOptions:f,search:v,toggleSelectTopic:j,clearResults:w,clearSelectedTopics:N}=function(){let[e,t]=(0,a.useState)(""),[r,s]=(0,a.useState)([]),[l,n]=(0,a.useState)(new Set),[i,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(p),m=(0,a.useRef)(null),x=(0,a.useCallback)(async()=>{if(!(e&&0!==e.trim().length&&!(e.length>100))){d("请输入有效的搜索关键词");return}o(!0),d(null),m.current&&m.current.abort(),m.current=new AbortController;let{signal:t}=m.current;try{let r=[];if(!u.postOnly){let t=await g.searchSubreddits(e);r=[...r,...t.slice(0,u.limit)]}if(!u.subredditOnly){let t=await g.searchPosts(e,void 0,u.sortBy,u.timeRange,u.limit);r=[...r,...t.slice(0,u.limit)]}t.aborted||s(r)}catch(e){t.aborted||(d(e instanceof Error?e.message:"搜索失败，请稍后重试"),console.error("搜索失败:",e))}finally{t.aborted||o(!1)}},[e,u]),b=(0,a.useCallback)(e=>{n(t=>{let r=new Set(t);return r.has(e.id)?r.delete(e.id):r.add(e.id),r})},[]),y=(0,a.useCallback)(()=>{s([]),d(null)},[]),f=(0,a.useCallback)(()=>{n(new Set)},[]),v=r.filter(e=>l.has(e.id));return{keyword:e,results:r,selectedTopicIds:l,selectedTopics:v,isLoading:i,error:c,searchOptions:u,setKeyword:t,setSearchOptions:h,search:x,toggleSelectTopic:b,clearResults:y,clearSelectedTopics:f}}(),{history:k,addToHistory:C,clearHistory:S,removeFromHistory:_}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,[t,r]=(0,a.useState)([]);return(0,a.useEffect)(()=>{try{let e=localStorage.getItem("reddit_search_history");if(e){let t=JSON.parse(e);Array.isArray(t)&&r(t)}}catch(e){console.error("加载搜索历史失败:",e)}},[]),{history:t,addToHistory:(0,a.useCallback)(t=>{t&&0!==t.trim().length&&r(r=>{let s=t.trim(),a=[s,...r.filter(e=>e!==s)].slice(0,e);try{localStorage.setItem("reddit_search_history",JSON.stringify(a))}catch(e){console.error("保存搜索历史失败:",e)}return a})},[e]),clearHistory:(0,a.useCallback)(()=>{r([]);try{localStorage.removeItem("reddit_search_history")}catch(e){console.error("清空搜索历史失败:",e)}},[]),removeFromHistory:(0,a.useCallback)(e=>{r(t=>{let r=t.filter(t=>t!==e);try{localStorage.setItem("reddit_search_history",JSON.stringify(r))}catch(e){console.error("删除搜索历史失败:",e)}return r})},[])}}(10),[E,O]=(0,a.useState)(!1),P=async()=>{await v(),C(l),O(!1)};return(0,s.jsx)("div",{className:r,children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"主题筛选"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm",children:"搜索并选择感兴趣的 Subreddit 或 Post 进行分析"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d,{value:l,onChange:e=>{y(e),e.length>=2?O(!0):O(!1)},onSearch:P,isLoading:c,searchHistory:k,onHistoryClick:e=>{y(e),O(!1)},onClearHistory:S,onRemoveHistory:_}),E&&l.length>=2&&(0,s.jsx)(x,{keyword:l,onSuggestionSelect:e=>{y(e),O(!1)},isLoading:c})]}),(0,s.jsx)(m,{options:b,onOptionsChange:f}),o.length>0&&(0,s.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("span",{className:"font-medium text-blue-900",children:["已选 ",o.length," 个主题"]}),(0,s.jsx)("button",{onClick:N,className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"清空已选"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[o.slice(0,5).map(e=>(0,s.jsxs)("span",{className:"inline-flex items-center px-3 py-1 bg-white border border-blue-300 rounded-full text-sm text-blue-800",children:["subscriber_count"in e?"社区":"帖子",": ",e.title.substring(0,20),e.title.length>20&&"..."]},e.id)),o.length>5&&(0,s.jsxs)("span",{className:"inline-flex items-center px-3 py-1 bg-blue-100 border border-blue-300 rounded-full text-sm text-blue-800",children:["+",o.length-5," 更多"]})]})]}),(0,s.jsx)(h,{topics:n,selectedTopicIds:i,onToggleSelect:e=>{j(e),null==t||t(o)},isLoading:c,error:u,searchKeyword:l})]})})}function f(){let[e,t]=(0,a.useState)([]);return(0,s.jsx)("main",{className:"min-h-screen bg-reddit-dark",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,s.jsxs)("header",{className:"mb-8 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Reddit Insight Tool"}),(0,s.jsx)("p",{className:"text-gray-300 text-lg",children:"发现热门主题，洞察用户痛点"})]}),(0,s.jsx)("section",{children:(0,s.jsx)("div",{className:"bg-reddit-card border border-reddit-border rounded-lg shadow-lg",children:(0,s.jsx)(y,{onSelectedTopicsChange:e=>{console.log("已选主题:",e),t(e)}})})})]})})}}},function(e){e.O(0,[137,971,117,744],function(){return e(e.s=2155)}),_N_E=e.O()}]);